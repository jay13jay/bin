BAK=$IFS; IFS=$(echo -en "\n\b"); for i in `find . -type f -regex ".*php\|.*pl\|.*txt\|.*html\|.*htm"`; do echo "$i :: `awk '/FilesMan|gzinflate\(base64_decode\(|phps(eclib|hell)\.sourceforge|(r57|c99|Dx|Crystal)[Ss]h[e3]ll|eval\(.*decode_base64\(|eval\(.*base64_decode\(|eval\(.*gzuncompress\(.*base64_decode\\(|[Ee]xecute [Cc]ommand:.*<input|keywordsRegex|method=\"post\".*name=\"uploader\"|\$a=.bas.*eval\(\$a/' "$i" | head -1`"; done | awk -F '::' '$2 !~ /^ *$/ {print $1}' > possible-hacked-files.txt; for i in `find . -type f -name ".htaccess"`; do echo "$i :: `awk '/php_value auto_append_file|Add(Type|Handler) .*(php|perl).* .*(gif|jpg|png|bmp|css|apng|pdf|jpeg)/' "$i"`"; done | awk -F '::' '$2 !~ /^ *$/ {print $0}' >> possible-hacked-files.txt; IFS=$BAK
